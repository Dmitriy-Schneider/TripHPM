<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤ –æ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞—Ö</title>
    <link rel="stylesheet" href="/css/style.css">
    <!-- Flatpickr –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/light.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <h1>üìã –û—Ç—á–µ—Ç—ã –æ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞—Ö</h1>
            </div>
            <div class="nav-user" id="navUser" style="display: none;">
                <span id="userInfo"></span>
                <button onclick="logout()" class="btn btn-secondary">–í—ã—Ö–æ–¥</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="authSection" class="auth-section">
            <div class="auth-card">
                <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>

                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <form id="loginForm" onsubmit="handleLogin(event)" style="display: block;">
                    <div class="form-group">
                        <label>–õ–æ–≥–∏–Ω</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">–í–æ–π—Ç–∏</button>
                </form>

                <!-- –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 2px solid #eee;">
                    <p style="color: #888; font-size: 13px; margin-bottom: 10px;">–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:</p>
                    <button type="button" onclick="quickTestLogin()" class="btn btn-secondary btn-block">
                        üöÄ –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥ (test/test)
                    </button>
                </div>

                <div id="authError" class="error-message" style="display: none;"></div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div id="mainSection" style="display: none;">
            <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ -->
            <div class="action-bar">
                <button onclick="showCreateTripModal()" class="btn btn-primary">
                    ‚ûï –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞
                </button>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ–∫ -->
            <div class="filters-bar">
                <div class="form-row">
                    <div class="form-group">
                        <label>–ì–æ—Ä–æ–¥</label>
                        <input type="text" id="filterCity" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–∞–º–∞—Ä–∞">
                    </div>
                    <div class="form-group">
                        <label>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</label>
                        <input type="text" id="filterOrg" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–û–û –ü–∞—Ä—Ç–Ω–µ—Ä">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Å</label>
                        <input type="date" id="filterDateFrom">
                    </div>
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ –ø–æ</label>
                        <input type="date" id="filterDateTo">
                    </div>
                    <div class="form-group" style="align-self: flex-end;">
                        <button type="button" onclick="resetTripFilters()" class="btn btn-secondary btn-small">
                            –°–±—Ä–æ—Å
                        </button>
                    </div>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ–∫ -->
            <div id="tripsList" class="trips-list">
                <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ -->
    <div id="createTripModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞</h2>
                <span class="close" onclick="closeCreateTripModal()">&times;</span>
            </div>
            <form id="createTripForm" onsubmit="handleCreateTrip(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>–ì–æ—Ä–æ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è *</label>
                        <input type="text" id="tripCity" placeholder="–ú–æ—Å–∫–≤–∞" required>
                    </div>
                    <div class="form-group">
                        <label>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</label>
                        <input type="text" id="tripOrg" placeholder="–û–û–û –ü–∞—Ä—Ç–Ω–µ—Ä">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label>–î–∞—Ç—ã –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ *</label>
                        <input type="text" id="tripDateRange" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã" required readonly>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</label>
                        <input type="time" id="tripDepartureTime" value="09:00">
                    </div>
                    <div class="form-group">
                        <label>–í—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è</label>
                        <input type="time" id="tripArrivalTime" value="18:00">
                    </div>
                </div>

                <div class="form-group">
                    <label>–¶–µ–ª—å –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ *</label>
                    <textarea id="tripPurpose" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–∏ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏" required>–£—á–∞—Å—Ç–∏–µ –≤ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞—Ö –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –ø–æ—Å—Ç–∞–≤–ª—è–µ–º–æ–π —Å—Ç–∞–ª–∏ –∏ —É—Å–ª–æ–≤–∏—è—Ö –ø–æ—Å—Ç–∞–≤–∫–∏</textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–ê–≤–∞–Ω—Å (—Ä—É–±)</label>
                        <input type="number" id="tripAdvance" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label>–°—Ç–∞–≤–∫–∞ —Å—É—Ç–æ—á–Ω—ã—Ö (—Ä—É–±)</label>
                        <input type="number" id="tripPerDiem" step="0.01" value="2000">
                    </div>
                </div>

                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏</label>
                    <div class="meals-group">
                        <div class="meal-item">
                            <label>–ó–∞–≤—Ç—Ä–∞–∫–∏</label>
                            <input type="number" id="tripBreakfast" value="0" min="0">
                        </div>
                        <div class="meal-item">
                            <label>–û–±–µ–¥—ã</label>
                            <input type="number" id="tripLunch" value="0" min="0">
                        </div>
                        <div class="meal-item">
                            <label>–£–∂–∏–Ω—ã</label>
                            <input type="number" id="tripDinner" value="0" min="0">
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" onclick="closeCreateTripModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ -->
    <div id="editTripModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫—É</h2>
                <span class="close" onclick="closeEditTripModal()">&times;</span>
            </div>
            <form id="editTripForm" onsubmit="handleEditTrip(event)">
                <input type="hidden" id="editTripId">

                <div class="form-row">
                    <div class="form-group">
                        <label>–ì–æ—Ä–æ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è *</label>
                        <input type="text" id="editTripCity" placeholder="–ú–æ—Å–∫–≤–∞" required>
                    </div>
                    <div class="form-group">
                        <label>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</label>
                        <input type="text" id="editTripOrg" placeholder="–û–û–û –ü–∞—Ä—Ç–Ω–µ—Ä">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label>–î–∞—Ç—ã –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ *</label>
                        <input type="text" id="editTripDateRange" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã" required readonly>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</label>
                        <input type="time" id="editTripDepartureTime">
                    </div>
                    <div class="form-group">
                        <label>–í—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è</label>
                        <input type="time" id="editTripArrivalTime">
                    </div>
                </div>

                <div class="form-group">
                    <label>–¶–µ–ª—å –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ *</label>
                    <textarea id="editTripPurpose" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–∏ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–ê–≤–∞–Ω—Å (—Ä—É–±)</label>
                        <input type="number" id="editTripAdvance" step="0.01">
                    </div>
                </div>

                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏</label>
                    <div class="meals-group">
                        <div class="meal-item">
                            <label>–ó–∞–≤—Ç—Ä–∞–∫–∏</label>
                            <input type="number" id="editTripBreakfast" min="0">
                        </div>
                        <div class="meal-item">
                            <label>–û–±–µ–¥—ã</label>
                            <input type="number" id="editTripLunch" min="0">
                        </div>
                        <div class="meal-item">
                            <label>–£–∂–∏–Ω—ã</label>
                            <input type="number" id="editTripDinner" min="0">
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" onclick="closeEditTripModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ–∫–∞ -->
    <div id="editReceiptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫</h2>
                <span class="close" onclick="closeEditReceiptModal()">&times;</span>
            </div>
            <form id="editReceiptForm" onsubmit="handleEditReceipt(event)">
                <input type="hidden" id="editReceiptId">

                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="editReceiptCategory" required>
                        <option value="taxi">–¢–∞–∫—Å–∏</option>
                        <option value="fuel">–¢–æ–ø–ª–∏–≤–æ</option>
                        <option value="airplane">–°–∞–º–æ–ª–µ—Ç</option>
                        <option value="train">–ü–æ–µ–∑–¥</option>
                        <option value="bus">–ê–≤—Ç–æ–±—É—Å</option>
                        <option value="hotel">–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞</option>
                        <option value="other">–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–∏–µ</option>
                        <option value="custom">–î—Ä—É–≥–æ–µ (–≤–≤–µ—Å—Ç–∏)</option>
                    </select>
                </div>

                <div class="form-group" id="editReceiptCategoryCustomGroup" style="display: none;">
                    <label>–°–≤–æ–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞</label>
                    <input type="text" id="editReceiptCategoryCustom" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠–ª–µ–∫—Ç—Ä–∏—á–∫–∞">
                </div>

                <div class="form-group">
                    <label>–°—É–º–º–∞ (—Ä—É–±)</label>
                    <input type="number" id="editReceiptAmount" step="0.01" required>
                </div>

                <div class="form-group">
                    <label>–î–∞—Ç–∞</label>
                    <input type="datetime-local" id="editReceiptDate">
                </div>

                <div class="modal-footer">
                    <button type="button" onclick="closeEditReceiptModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ -->
    <div id="viewTripModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞ #<span id="viewTripId"></span></h2>
                <span class="close" onclick="closeViewTripModal()">&times;</span>
            </div>
            <div id="viewTripContent">
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–µ -->
                <div class="trip-info">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <div id="tripDetails"></div>
                </div>

                <!-- –¢–∞–±—ã –¥–ª—è —ç—Ç–∞–ø–æ–≤ -->
                <div class="stage-tabs">
                    <button class="stage-tab active" onclick="showStage('pre-trip')" id="tabPreTrip">
                        üìã –≠—Ç–∞–ø 1: –î–û –ø–æ–µ–∑–¥–∫–∏
                    </button>
                    <button class="stage-tab" onclick="showStage('post-trip')" id="tabPostTrip">
                        üìä –≠—Ç–∞–ø 2: –ü–û–°–õ–ï –ø–æ–µ–∑–¥–∫–∏
                    </button>
                </div>

                <!-- –≠–¢–ê–ü 1: –î–û –ü–û–ï–ó–î–ö–ò -->
                <div id="stagePreTrip" class="stage-content active">
                    <div class="stage-header">
                        <h3>üìã –î–æ–∫—É–º–µ–Ω—Ç—ã –î–û –ø–æ–µ–∑–¥–∫–∏</h3>
                        <p class="stage-description">–ü—Ä–∏–∫–∞–∑ –∏ –°–ª—É–∂–µ–±–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞–Ω—Å–∞</p>
                    </div>

                    <!-- –ö–ù–û–ü–ö–ò –í–í–ï–†–•–£ -->
                    <div class="action-buttons" style="margin-bottom: 15px;">
                        <button onclick="showPreviewPreTrip()" class="btn btn-primary">
                            üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                        </button>
                        <button onclick="generatePreTrip()" class="btn btn-success">
                            ‚úì –°–æ–∑–¥–∞—Ç—å –ü—Ä–∏–∫–∞–∑ + –°–ó
                        </button>
                    </div>

                    <div id="preDocsStatus"></div>

                    <div class="stage-info">
                        <div class="info-row">
                            <span class="info-label">–°—É–º–º–∞ –∞–≤–∞–Ω—Å–∞:</span>
                            <span class="info-value" id="preAdvanceAmount">0 ‚ÇΩ</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:</span>
                            <input type="date" id="preDocsDateInput" class="date-input-small">
                        </div>
                    </div>

                    <div id="preFolderPath" style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 8px; display: none;">
                        <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <strong>üìÅ</strong>
                            <span id="preFolderPathText" style="font-family: monospace; font-size: 12px; word-break: break-all;"></span>
                            <button onclick="copyFolderPath('pre')" class="btn btn-small" style="padding: 4px 8px; font-size: 11px;">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                    </div>
                </div>

                <!-- –≠–¢–ê–ü 2: –ü–û–°–õ–ï –ü–û–ï–ó–î–ö–ò -->
                <div id="stagePostTrip" class="stage-content" style="display: none;">
                    <div class="stage-header">
                        <h3>üìä –î–æ–∫—É–º–µ–Ω—Ç—ã –ü–û–°–õ–ï –ø–æ–µ–∑–¥–∫–∏</h3>
                        <p class="stage-description">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ–∫–∏ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ê–≤–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç</p>
                    </div>

                    <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô –í–í–ï–†–•–£ -->
                    <div class="documents-section" style="margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                            <div class="info-row" style="margin: 0;">
                                <span class="info-label">–î–∞—Ç–∞ –ê–û:</span>
                                <input type="date" id="aoDateInput" class="date-input-small">
                            </div>
                            <div class="action-buttons" style="margin: 0;">
                                <button onclick="showPreviewPostTrip()" class="btn btn-primary">
                                    üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button onclick="generatePostTrip()" class="btn btn-success">
                                    ‚úì –°–æ–∑–¥–∞—Ç—å –ê–û
                                </button>
                            </div>
                        </div>
                        <div id="postDocsStatus" style="margin-top: 10px;"></div>
                        <div id="postFolderPath" style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 8px; display: none;">
                            <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                                <strong>üìÅ</strong>
                                <span id="postFolderPathText" style="font-family: monospace; font-size: 12px; word-break: break-all;"></span>
                                <button onclick="copyFolderPath('post')" class="btn btn-small" style="padding: 4px 8px; font-size: 11px;">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫–æ–≤ -->
                    <div class="receipts-section">
                        <h4>–ß–µ–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã</h4>
                        <div class="upload-area">
                            <input type="file" id="receiptFile" accept="image/*,application/pdf" multiple style="display: none;" onchange="handleReceiptUpload(event)">
                            <button onclick="document.getElementById('receiptFile').click()" class="btn btn-secondary">
                                üìé –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫–∏
                            </button>
                            <select id="receiptCategory" class="category-select">
                                <option value="taxi">–¢–∞–∫—Å–∏</option>
                                <option value="fuel">–¢–æ–ø–ª–∏–≤–æ</option>
                                <option value="airplane">–°–∞–º–æ–ª—ë—Ç</option>
                                <option value="train">–ü–æ–µ–∑–¥</option>
                                <option value="bus">–ê–≤—Ç–æ–±—É—Å</option>
                                <option value="hotel">–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞</option>
                                <option value="other">–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–∏–µ</option>
                                <option value="custom">–î—Ä—É–≥–æ–µ (–≤–≤–µ—Å—Ç–∏)</option>
                            </select>
                            <select id="documentType" class="category-select">
                                <option value="fiscal">üí∞ –° —Å—É–º–º–æ–π (—á–µ–∫)</option>
                                <option value="boarding">üìÑ –ë–µ–∑ —Å—É–º–º—ã (–ø–æ—Å–∞–¥–æ—á–Ω—ã–π)</option>
                            </select>
                        </div>
                        <div class="form-row" id="receiptCategoryCustomGroup" style="display: none;">
                            <div class="form-group" style="flex: 1;">
                                <label>–°–≤–æ–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞</label>
                                <input type="text" id="receiptCategoryCustom" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠–ª–µ–∫—Ç—Ä–∏—á–∫–∞">
                            </div>
                        </div>
                        <div id="receiptsList" class="receipts-list">
                            <!-- –°–ø–∏—Å–æ–∫ —á–µ–∫–æ–≤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="progressModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h2>
            </div>
            <div style="padding: 20px;">
                <div id="progressText" style="margin-bottom: 15px; text-align: center; font-size: 16px;">
                    –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤...
                </div>
                <div style="width: 100%; background-color: #f0f0f0; border-radius: 10px; overflow: hidden; height: 30px;">
                    <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #007bff, #0056b3); transition: width 0.3s;"></div>
                </div>
                <div id="progressDetails" style="margin-top: 10px; font-size: 14px; color: #666; text-align: center;">
                    0 –∏–∑ 0 —Ñ–∞–π–ª–æ–≤
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –î–û –ø–æ–µ–∑–¥–∫–∏ -->
    <div id="previewPreTripModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä: –î–û –ø–æ–µ–∑–¥–∫–∏</h2>
                <span class="close" onclick="closePreviewPreTripModal()">&times;</span>
            </div>
            <div style="padding: 20px;">
                <div id="previewPreTripContent"></div>
                <div id="previewPreTripWarnings" style="margin-top: 20px;"></div>
                <div class="modal-footer">
                    <button type="button" onclick="closePreviewPreTripModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" onclick="confirmGeneratePreTrip()" class="btn btn-primary">
                        ‚úì –°–æ–∑–¥–∞—Ç—å –ü—Ä–∏–∫–∞–∑ + –°–ó
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ü–û–°–õ–ï –ø–æ–µ–∑–¥–∫–∏ -->
    <div id="previewPostTripModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>üìä –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä: –ü–û–°–õ–ï –ø–æ–µ–∑–¥–∫–∏</h2>
                <span class="close" onclick="closePreviewPostTripModal()">&times;</span>
            </div>
            <div style="padding: 20px;">
                <div id="previewPostTripContent"></div>
                <div id="previewPostTripWarnings" style="margin-top: 20px;"></div>
                <div class="modal-footer">
                    <button type="button" onclick="closePreviewPostTripModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" onclick="confirmGeneratePostTrip()" class="btn btn-primary" id="confirmGeneratePostBtn">
                        ‚úì –°–æ–∑–¥–∞—Ç—å –ê–≤–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) -->
    <div id="previewModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏</h2>
                <span class="close" onclick="closePreviewModal()">&times;</span>
            </div>
            <div style="padding: 20px;">
                <div id="previewContent"></div>

                <div id="previewWarnings" style="margin-top: 20px;"></div>

                <div class="modal-footer">
                    <button type="button" onclick="closePreviewModal()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" onclick="confirmGeneration()" class="btn btn-primary" id="confirmGenerateBtn">
                        ‚úì –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification"></div>

    <script src="/js/app.js"></script>
</body>
</html>
